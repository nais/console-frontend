<script lang="ts">
	import { severityToColor } from '$lib/utils/vulnerabilities';

	import { BodyShort, Tooltip } from '@nais/ds-svelte-community';

	type VulnerabilitySummary = {
		critical: number;
		high: number;
		medium: number;
		low: number;
		unassigned: number;
		riskScore: number;
	};

	interface Props {
		summary: VulnerabilitySummary;
	}

	let { summary }: Props = $props();

	const categories = ['critical', 'high', 'medium', 'low', 'unassigned'] as const;
</script>

<BodyShort>Risk score: {summary['riskScore']}</BodyShort>
<div class="vulnerability-summary">
	{#each categories as category (category)}
		<Tooltip content={category}>
			<BodyShort class="vulnerability-count" style="background-color: {severityToColor(category)}">
				{summary[category]}
			</BodyShort>
		</Tooltip>
	{/each}
</div>

<style>
	.vulnerability-summary {
		display: flex;
		gap: 1px;
		margin-bottom: var(--a-spacing-3);

		:global(:first-child > .vulnerability-count) {
			border-top-left-radius: 4px;
			border-bottom-left-radius: 4px;
		}

		:global(:last-child > .vulnerability-count) {
			border-top-right-radius: 4px;
			border-bottom-right-radius: 4px;
		}

		:global(.vulnerability-count) {
			padding: 4px 10px;
		}
	}
</style>
