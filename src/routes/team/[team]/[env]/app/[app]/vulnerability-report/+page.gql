query ApplicationImageDetails($team: Slug!, $env: String!, $app: String!, $from: Date!)
@cache(policy: NetworkOnly) {
	team(slug: $team) {
		slug
		environment(name: $env) {
			environment {
				name
			}
			workload(name: $app) {
				__typename
				name
				team {
					slug
				}
				teamEnvironment {
					environment {
						name
					}
				}
				status {
					errors {
						__typename
						level
						... on WorkloadStatusVulnerable {
							summary {
								critical
								riskScore
							}
						}
					}
				}
				imageVulnerabilityHistory(from: $from) {
					samples {
						date
						summary {
							critical
							high
							medium
							low
							unassigned
						}
					}
				}
				image {
					id
					name
					tag
					hasSBOM
					vulnerabilitySummary {
						critical
						high
						medium
						low
						unassigned
						riskScore
					}
					workloadReferences {
						nodes {
							workload {
								id
								__typename
								team {
									slug
								}
								teamEnvironment {
									environment {
										name
									}
								}
								name
							}
						}
					}
				}
			}
		}
	}
}
